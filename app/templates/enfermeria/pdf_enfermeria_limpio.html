<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Registros Enfermería - {{ paciente.nombre_completo }}</title><style>@page{margin:1cm;size:A4;}body{font-family:Arial,sans-serif;font-size:11px;line-height:1.3;color:#000;margin:0;padding:20px;}.header{text-align:center;border-bottom:2px solid #000;padding-bottom:10px;margin-bottom:20px}h1{font-size:16px;margin:5px 0;font-weight:bold}.info-paciente{font-size:12px;margin:10px 0;border:1px solid #000;padding:8px}.section{margin-bottom:25px}.section-title{font-size:12px;font-weight:bold;background:#e0e0e0;border:1px solid #000;padding:8px 6px;margin-bottom:5px}.table{width:100%;border-collapse:collapse;border:1px solid #000;font-size:10px;margin:0}.table th{background:#d0d0d0;border:1px solid #000;padding:6px 4px;text-align:center;font-weight:bold;font-size:9px}.table td{border:1px solid #000;padding:4px 3px;vertical-align:top;font-size:9px}.bold{font-weight:bold}.empty-row{text-align:center;padding:15px;font-style:italic;color:#666;background:#f8f8f8;border:1px solid #ccc}.footer{text-align:center;font-size:9px;color:#666;margin-top:25px;border-top:1px solid #000;padding-top:12px}.no-data{display:none}</style></head><body>
<div class="header">
<h1>REGISTROS DE ENFERMERÍA</h1>
<p class="info-paciente"><strong>Documento:</strong> {{ paciente.numero }} | <strong>Fecha:</strong> {{ fecha_generacion }}</p>
</div>

<!-- SIGNOS VITALES + GLICEMIA -->
<div class="section">
<div class="section-title">SIGNOS VITALES / GLICEMIA</div>
<table class="table">
<thead><tr><th>FECHA</th><th>HORA</th><th>TURNO</th><th>TA</th><th>FC</th><th>FR</th><th>TEMP</th><th>SAT O₂</th><th>GLICEMIA</th><th>OBSERVACIONES</th></tr></thead>
<tbody>
{% for r in registros %}
{% set sv = r.signos_vitales_dict if r.signos_vitales_dict else {} %}
{% if sv.ta or sv.fc or sv.fr or sv.temp or sv.so2 or r.control_glicemia %}
<tr>
<td>{{ r.fecha_registro.strftime('%d/%m/%Y') if r.fecha_registro else '' }}</td>
<td>{{ r.fecha_registro.strftime('%H:%M') if r.fecha_registro else '' }}</td>
<td>{{ r.turno or '' }}</td>
<td>{{ sv.ta or '' }}</td>
<td>{{ sv.fc or '' }}</td>
<td>{{ sv.fr or '' }}</td>
<td>{{ sv.temp or '' }}</td>
<td>{{ sv.so2 or '' }}</td>
<td class="bold">{{ r.control_glicemia or '' }}</td>
<td>{{ r.observaciones or '' }}</td>
</tr>
{% endif %}
{% endfor %}
{% if not registros %}
<tr class="empty-row"><td colspan="10">Sin signos vitales registrados</td></tr>
{% endif %}
</tbody>
</table>
</div>

<!-- BALANCE DE LÍQUIDOS - SOLO CANTIDAD -->
<div class="section">
<div class="section-title">BALANCE DE LÍQUIDOS</div>
<table class="table">
<thead><tr><th>FECHA</th><th>HORA</th><th>TURNO</th><th>ADMINISTRADOS</th><th>ELIMINADOS</th></tr></thead>
<tbody>
{% for r in registros %}
{% set liq = r.balance_liquidos_dict if r.balance_liquidos_dict else {} %}
{% set admin = liq.administrados if liq.administrados else {} %}
{% set elim = liq.eliminados if liq.eliminados else {} %}
{% if admin.cantidad or elim.cantidad %}
<tr>
<td>{{ r.fecha_registro.strftime('%d/%m/%Y') if r.fecha_registro else '' }}</td>
<td>{{ r.fecha_registro.strftime('%H:%M') if r.fecha_registro else '' }}</td>
<td>{{ r.turno or '' }}</td>
<td class="bold">{{ admin.cantidad or '' }}</td>
<td class="bold">{{ elim.cantidad or '' }}</td>
</tr>
{% endif %}
{% endfor %}
{% if not registros %}
<tr class="empty-row"><td colspan="5">Sin balance registrado</td></tr>
{% endif %}
</tbody>
</table>
</div>

<!-- NOTAS DE ENFERMERÍA -->
<div class="section">
<div class="section-title">NOTAS DE ENFERMERÍA</div>
<table class="table">
<thead><tr><th>FECHA</th><th>HORA</th><th>TURNO</th><th>TIPO</th><th>NOTA</th></tr></thead>
<tbody>
{% for r in registros %}
{% if r.tipo_nota and r.texto_nota %}
<tr>
<td>{{ r.fecha_registro.strftime('%d/%m/%Y') if r.fecha_registro else '' }}</td>
<td>{{ r.fecha_registro.strftime('%H:%M') if r.fecha_registro else '' }}</td>
<td>{{ r.turno or '' }}</td>
<td>{{ r.tipo_nota }}</td>
<td style="max-width:200px;word-wrap:break-word;">{{ r.texto_nota }}</td>
</tr>
{% endif %}
{% endfor %}
{% if not registros %}
<tr class="empty-row"><td colspan="5">Sin notas registradas</td></tr>
{% endif %}
</tbody>
</table>
</div>

<!-- MEDICAMENTOS -->
<div class="section">
<div class="section-title">MEDICAMENTOS</div>
<table class="table">
<thead><tr><th>FECHA</th><th>HORA</th><th>CÓDIGO</th><th>CANT</th><th>UNID</th><th>VÍA</th><th>OBSERVACIONES</th></tr></thead>
<tbody>
{% for admin in medicamentos %}
<tr>
<td>{{ admin.hora_administracion.strftime('%d/%m/%Y') if admin.hora_administracion else '' }}</td>
<td>{{ admin.hora_administracion.strftime('%H:%M') if admin.hora_administracion else '' }}</td>
<td>{{ admin.medicamento.codigo if admin.medicamento else 'N/A' }}</td>
<td class="bold">{{ admin.cantidad }}</td>
<td>{{ admin.unidad }}</td>
<td>{{ admin.via or '-' }}</td>
<td>{{ admin.observaciones or '-' }}</td>
</tr>
{% endfor %}
{% if not medicamentos %}
<tr class="empty-row"><td colspan="7">Sin medicamentos administrados</td></tr>
{% endif %}
</tbody>
</table>
</div>

<div class="footer">
Sistema de Gestión Hospitalaria - {{ fecha_generacion }}
</div>
</body></html>
