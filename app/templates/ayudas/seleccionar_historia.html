{% extends "base.html" %}

{% block title %}Seleccionar Historia - Software SM{% endblock %}

{% block head %}
<style>
    /* Estilos específicos para esta página que complementan la base */
    .container-clinico {
      background-color: #f0e7d8; 
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .titulo-principal {
      color: #236e7b;           
      font-weight: 700;
      text-transform: uppercase;
      border-bottom: 2px solid #236e7b;
      display: inline-block;
      margin-bottom: 20px;
    }

    .card-resumen {
      background-color: rgba(255, 255, 255, 0.5);
      border: 1px solid #236e7b;
      border-left: 5px solid #236e7b;
      border-radius: 8px;
    }

    .table thead {
      background-color: #236e7b;
      color: #f0e7d8;
    }

    .btn-clinico {
      background-color: #236e7b;
      color: #f0e7d8;
      border: none;
      transition: background 0.3s;
    }

    .btn-clinico:hover {
      background-color: #0b6169;
      color: #ffffff;
    }

    .link-accion {
      color: #0b6169;
      font-weight: 600;
      text-decoration: none;
    }

    .text-secundario {
      color: #5f5f5f;
      font-size: 0.85rem;
      font-weight: bold;
      text-transform: uppercase;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-clinico shadow">
    
    <header class="mb-4 text-center text-md-start">
      <h2 class="titulo-principal">Ayudas Diagnósticas</h2>
      <p style="color: #5f5f5f;">Seleccione una historia clínica para gestionar las ayudas</p>
    </header>

    <div class="card card-resumen mb-4 shadow-sm">
      <div class="card-body">
        <div class="row">
          <div class="col-md-4 mb-2 mb-md-0">
            <small class="text-secundario d-block">Paciente</small>
            <strong style="font-size: 1.1rem; color: #0b6169;">{{ paciente.nombre }}</strong>
          </div>
          <div class="col-md-4 mb-2 mb-md-0 border-md-start">
            <small class="text-secundario d-block">Documento</small>
            <strong style="color: #0b6169;">{{ paciente.numero }}</strong>
          </div>
          <div class="col-md-4 border-md-start">
            <small class="text-secundario d-block">Cama</small>
            <strong style="color: #0b6169;">{{ paciente.cama or 'No asignada' }}</strong>
          </div>
        </div>
      </div>
    </div>

    <div class="table-responsive bg-white rounded shadow-sm">
      <table class="table table-hover align-middle mb-0">
        <thead>
          <tr>
            <th class="ps-3">ID</th>
            <th>Tipo de historia</th>
            <th>Número ingreso</th>
            <th>Fecha registro</th>
            <th class="text-center">Acciones</th>
          </tr>
        </thead>
        <tbody>
        {% if historias %}
          {% for h in historias %}
            <tr>
              <td class="ps-3 text-muted">#{{ h.id }}</td>
              <td><strong>{{ h.tipo_historia }}</strong></td>
              <td>{{ h.numero_ingreso }}</td>
              <td>{{ h.fecha_registro.strftime('%d/%m/%Y %H:%M') }}</td>
              <td class="text-center">
                <a href="{{ url_for('ayudas.menu_ayudas_historia', historia_id=h.id) }}"
                   class="btn btn-sm btn-clinico px-4 shadow-sm">
                   Ver Ayudas
                </a>
              </td>
            </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="5" class="text-center py-5 text-muted">
              No hay historias clínicas registradas para este paciente.
            </td>
          </tr>
        {% endif %}
        </tbody>
      </table>
    </div>

    <div class="mt-4 pt-3 border-top d-flex justify-content-between">
      <a href="{{ url_for('ayudas.inicio_ayudas') }}" class="link-accion">
        ← Buscar otro paciente
      </a>
      <a href="{{ url_for('menu.inicio') }}" class="link-accion">
        Volver al Menú
      </a>
    </div>

</div>
{% endblock %}